<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.16">
<title>Web Application Proxy and AD FS on the AWS Cloud</title>
<style>

/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#34478c;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{
  border-bottom:1px solid #e7e7e9;
  padding-bottom:.5em;
  width: 230px;
}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{
  font-family: "Work Sans", "Helvetica", "Tahoma", "Geneva", "Arial", sans-serif;
  text-decoration:none;
  color:#ccc;
  display: block;
  font-size:1rem;
  line-height: 2rem;
}
#toc a:hover{color:#e6e6e6}
#toc a:active{
  text-decoration:none;
  color:#777;
}
#toctitle{
  padding-top:0;
  overflow:hidden;
  background:#283e5b;
  /* border-bottom: 4px solid #435c7c; */
  width:320px;
  height:154px;
  top:0;
  left:0;
  color: #283e5b;
}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#1c222a;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;/*! padding:1.25em 1em; */height:100%;overflow:auto;padding-right: 0px;}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{
  font-size:1.375em;
  background-repeat: no-repeat;
  background-size: 160.8px 136.483px;
  background-position: center;
  }
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:#1c222a;padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44;/*! background: #e6e6e6; */}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";color: rgb(3, 87, 21);}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}

/* -------------------------   QS CSS entries ---------------------------- */
@font-face {
  font-family: 'Amazon Ember Light';
  src        :
    local('Amazon Ember Light'),
    local('AmazonEmberLight'),
    url('https://m.media-amazon.com/images/G/01/AUIClients/AmazonUIBaseCSS-amazonember_lt-019e0ec3f9b521056e66e31fdcbc8323e5cd1938._V299195751_.woff2') format('woff2'),
    url('https://m.media-amazon.com/images/G/01/AUIClients/AmazonUIBaseCSS-amazonember_lt-bc9ed0fce860a46f3cb061034280c23400e6e8b6._V299195751_.woff') format('woff');
}

@font-face {
  font-family: 'Amazon Ember Light';
  font-weight: 700;
  src        :
    local('Amazon Ember Light'),
    local('AmazonEmberLight-Bold'),
    url('https://m.media-amazon.com/images/G/01/AUIClients/AmazonUIBaseCSS-amazonember_bd-46b91bda68161c14e554a779643ef4957431987b._V2_.woff2') format('woff2'),
    url('https://m.media-amazon.com/images/G/01/AUIClients/AmazonUIBaseCSS-amazonember_bd-b605252f87b8b3df5ae206596dac0938fc5888bc._V2_.woff') format('woff');
}

@font-face {
  font-family: 'Amazon Ember Light';
  font-style : italic;
  src        :
    local('Amazon Ember Light'),
    local('AmazonEmberLight-Italic'),
    url('https://m.media-amazon.com/images/G/01/AUIClients/AmazonUIBaseCSS-amazonember_ltit-96be47a559388a2b219577124589435c09a361fe._V299195751_.woff2') format('woff2'),
    url('https://m.media-amazon.com/images/G/01/AUIClients/AmazonUIBaseCSS-amazonember_ltit-b561f11b5c8be92ac17f6b713dd9d4b6e2f00c8d._V299195751_.woff') format('woff');
}

@font-face {
  font-family: 'Amazon Ember Light';
  font-style : italic;
  font-weight: 700;
  src        :
    local('Amazon Ember Light'),
    local('AmazonEmberLight-BoldItalic'),
    url('https://m.media-amazon.com/images/G/01/AUIClients/AmazonUIBaseCSS-amazonember_ltit-96be47a559388a2b219577124589435c09a361fe._V299195751_.woff2') format('woff2'),
    url('https://m.media-amazon.com/images/G/01/AUIClients/AmazonUIBaseCSS-amazonember_ltit-b561f11b5c8be92ac17f6b713dd9d4b6e2f00c8d._V299195751_.woff') format('woff');
}

@font-face {
  font-family: 'Amazon Ember Regular';
  src        :
    local('Amazon Ember Regular'),
    local('AmazonEmberRegular'),
    url('https://m.media-amazon.com/images/G/01/AUIClients/AmazonUIBaseCSS-amazonember_rg-fd81bacb6a659a8c8c95828226b74594ab985060._V299195749_.woff2') format('woff2'),
    url('https://m.media-amazon.com/images/G/01/AUIClients/AmazonUIBaseCSS-amazonember_rg-0acf3bc8b64d470d8888d84741a19533394654c6._V299195749_.woff') format('woff');
}

@font-face {
  font-family: 'Amazon Ember Regular';
  font-weight: 700;
  src        :
    local('Amazon Ember Regular'),
    local('AmazonEmberRegular-Bold'),
    url('https://m.media-amazon.com/images/G/01/AUIClients/AmazonUIBaseCSS-amazonember_bd-46b91bda68161c14e554a779643ef4957431987b._V2_.woff2') format('woff2'),
    url('https://m.media-amazon.com/images/G/01/AUIClients/AmazonUIBaseCSS-amazonember_bd-b605252f87b8b3df5ae206596dac0938fc5888bc._V2_.woff') format('woff');
}

@font-face {
  font-family: 'Amazon Ember Regular';
  font-style : italic;
  src        :
    local('Amazon Ember Regular'),
    local('AmazonEmberRegular-Italic'),
    url('https://m.media-amazon.com/images/G/01/AUIClients/AmazonUIBaseCSS-amazonember_rgit-af980fe9c64fc17ece72cba4e3e7fdf54babeea6._V299195748_.woff2') format('woff2'),
    url('https://m.media-amazon.com/images/G/01/AUIClients/AmazonUIBaseCSS-amazonember_rgit-4fae4842b3446774d86579b9b024858a848644e8._V299195748_.woff') format('woff');
}

@font-face {
  font-family: 'Amazon Ember Regular';
  font-style : italic;
  font-weight: 700;
  src        :
    local('Amazon Ember Regular'),
    local('AmazonEmberRegular-BoldItalic'),
    url('https://m.media-amazon.com/images/G/01/AUIClients/AmazonUIBaseCSS-amazonember_bdit-80ff7aba37dd1ff5a6b90233a19e3a780a96dc2f._V2_.woff2') format('woff2'),
    url('https://m.media-amazon.com/images/G/01/AUIClients/AmazonUIBaseCSS-amazonember_bdit-57598ce426a612be5a1d15eee08252668fca5e7a._V2_.woff') format('woff');
}

@font-face {
  font-family: 'Amazon Ember Medium';
  src        :
    local('Amazon Ember Medium'),
    local('AmazonEmberMedium'),
    url('https://m.media-amazon.com/images/G/01/amazonservices/fonts/amazonember_md_base-webfont._V525237381_.woff2') format('woff2'),
    url('https://m.media-amazon.com/images/G/01/amazonservices/fonts/amazonember_md_base-webfont._V525237386_.woff') format('woff');
}

@font-face {
  font-family: 'Amazon Ember Medium';
  font-weight: 700;
  src        :
    local('Amazon Ember Medium'),
    local('AmazonEmberMedium-Bold'),
    url('https://m.media-amazon.com/images/G/01/AUIClients/AmazonUIBaseCSS-amazonember_bd-46b91bda68161c14e554a779643ef4957431987b._V2_.woff2') format('woff2'),
    url('https://m.media-amazon.com/images/G/01/AUIClients/AmazonUIBaseCSS-amazonember_bd-b605252f87b8b3df5ae206596dac0938fc5888bc._V2_.woff') format('woff');
}

@font-face {
  font-family: 'Amazon Ember Medium';
  font-style : italic;
  src        :
    local('Amazon Ember Medium'),
    local('AmazonEmberMedium-Italic'),
    url('https://m.media-amazon.com/images/G/01/agdm/fonts/amazonember/amazonember_mdit-webfont._V522331917_.woff2') format('woff2'),
    url('https://m.media-amazon.com/images/G/01/agdm/fonts/amazonember/amazonember_mdit-webfont._V522331917_.woff') format('woff');
}

@font-face {
  font-family: 'Amazon Ember Medium';
  font-style : italic;
  font-weight: 700;
  src        :
    local('Amazon Ember Medium'),
    local('AmazonEmberMedium-BoldItalic'),
    url('https://m.media-amazon.com/images/G/01/AUIClients/AmazonUIBaseCSS-amazonember_bdit-80ff7aba37dd1ff5a6b90233a19e3a780a96dc2f._V2_.woff2') format('woff2'),
    url('https://m.media-amazon.com/images/G/01/AUIClients/AmazonUIBaseCSS-amazonember_bdit-57598ce426a612be5a1d15eee08252668fca5e7a._V2_.woff') format('woff');
}

@font-face {
  font-family: 'Amazon Ember Heavy';
  src        :
    local('Amazon Ember Heavy'),
    local('AmazonEmberHeavy'),
    url('https://m.media-amazon.com/images/G/01/acs/fonts/amazonember_he-webfont._V278446113_.woff2') format('woff2'),
    url('https://m.media-amazon.com/images/G/01/acs/fonts/amazonember_he-webfont._V278446115_.woff') format('woff');
}

@font-face {
  font-family: 'Amazon Ember Heavy';
  font-weight: 700;
  src        :
    local('Amazon Ember Heavy'),
    local('AmazonEmberHeavy-Bold'),
    url('https://m.media-amazon.com/images/G/01/AUIClients/AmazonUIBaseCSS-amazonember_bd-46b91bda68161c14e554a779643ef4957431987b._V2_.woff2') format('woff2'),
    url('https://m.media-amazon.com/images/G/01/AUIClients/AmazonUIBaseCSS-amazonember_bd-b605252f87b8b3df5ae206596dac0938fc5888bc._V2_.woff') format('woff');
}

@font-face {
  font-family: 'Amazon Ember Heavy';
  font-style : italic;
  src        :
    local('Amazon Ember Heavy'),
    local('AmazonEmberHeavy-Italic'),
    url('https://m.media-amazon.com/images/G/01/AUIClients/AmazonUIBaseCSS-amazonember_bdit-80ff7aba37dd1ff5a6b90233a19e3a780a96dc2f._V2_.woff2') format('woff2'),
    url('https://m.media-amazon.com/images/G/01/AUIClients/AmazonUIBaseCSS-amazonember_bdit-57598ce426a612be5a1d15eee08252668fca5e7a._V2_.woff') format('woff');
}

@font-face {
  font-family: 'Amazon Ember Heavy';
  font-style : italic;
  font-weight: 700;
  src        :
    local('Amazon Ember Heavy'),
    local('AmazonEmberHeavy-BoldItalic'),
    url('https://m.media-amazon.com/images/G/01/agdm/fonts/amazonember/amazonember_heit-webfont._V522331917_.woff2') format('woff2'),
    url('https://m.media-amazon.com/images/G/01/agdm/fonts/amazonember/amazonember_heit-webfont._V522331917_.woff') format('woff');
}

@font-face {
  font-family: 'Amazon Ember Thin';
  src        :
    local('Amazon Ember Thin'),
    local('AmazonEmberThin'),
    url('https://m.media-amazon.com/images/G/01/mobile-apps/devportal2/content/alexa/prize/20160810/fonts/AmazonEmber/amazonember-thin-webfont._V282715032_.woff2') format('woff2'),
    url('https://m.media-amazon.com/images/G/01/mobile-apps/devportal2/content/alexa/prize/20160810/fonts/AmazonEmber/amazonember-thin-webfont._V282715033_.woff') format('woff');
}

@font-face {
  font-family: 'Amazon Ember Thin';
  font-weight: 700;
  src        :
    local('Amazon Ember Thin'),
    local('AmazonEmberThin-Bold'),
    url('https://m.media-amazon.com/images/G/01/AUIClients/AmazonUIBaseCSS-amazonember_bd-46b91bda68161c14e554a779643ef4957431987b._V2_.woff2') format('woff2'),
    url('https://m.media-amazon.com/images/G/01/AUIClients/AmazonUIBaseCSS-amazonember_bd-b605252f87b8b3df5ae206596dac0938fc5888bc._V2_.woff') format('woff');
}

@font-face {
  font-family: 'Amazon Ember Thin';
  font-style : italic;
  src        :
    local('Amazon Ember Thin'),
    local('AmazonEmberThin-Italic'),
    url('https://m.media-amazon.com/images/G/01/mobile-apps/devportal2/content/alexa/prize/20160810/fonts/AmazonEmber/amazonember-thinit-webfont._V282715033_.woff2') format('woff2'),
    url('https://m.media-amazon.com/images/G/01/mobile-apps/devportal2/content/alexa/prize/20160810/fonts/AmazonEmber/amazonember-thinit-webfont._V282715032_.woff') format('woff');
}

@font-face {
  font-family: 'Amazon Ember Thin';
  font-style : italic;
  font-weight: 700;
  src        :
    local('Amazon Ember Thin'),
    local('AmazonEmberThin-BoldItalic'),
    url('https://m.media-amazon.com/images/G/01/AUIClients/AmazonUIBaseCSS-amazonember_bdit-80ff7aba37dd1ff5a6b90233a19e3a780a96dc2f._V2_.woff2') format('woff2'),
    url('https://m.media-amazon.com/images/G/01/AUIClients/AmazonUIBaseCSS-amazonember_bdit-57598ce426a612be5a1d15eee08252668fca5e7a._V2_.woff') format('woff');
}


.tip {
  border-top: 30px solid rgba(92, 184, 92, 0.8);
  background: #E6F9E6;
}

.note {
  border-top: 30px solid #6AB0DE;
  background: #E7F2FA;
}

.warning {
  border-top: 30px solid #F0B37E;
  background: #FFF2DB;
}

.caution {
  border-top: 30px solid rgba(217, 83, 79, 0.8);
  background: #FAE2E2;
}

.important {
  border-top: 30px solid rgba(217, 83, 79, 0.8);
  background: #FAE2E2;
}

#content {
  max-width: 100rem;
  padding-left: 5rem;
  padding-right: 5rem;
}

body {
  font-family: "Amazon Ember Regular", "Helvetica", "Tahoma", "Geneva", "Arial", sans-serif;
}

/* added */
h1,
h2,
h3,
h4,
h5,
h6 {
  margin        : 0.85rem 0 1.7rem 0;
  text-rendering: optimizeLegibility;
  color: #ec7211;
}

p {
  margin: 1rem 0;
}

/* QS Table of Contents */

#toc {
  overflow-x: hidden !important;
}

#toc>ul li {
  padding    : 0.3rem 0.6rem;
  margin-top : 0;
  line-height: 1;
}

#toc>ul li a {
  line-height: 1.6;
}

#toc a {
  /* TOC details */
  font-family  : "Amazon Ember Light", "Helvetica", "Tahoma", "Geneva", "Arial", sans-serif;
  margin-left  : -1rem;
  margin-right : -1rem;
  padding-left : 1rem;
  padding-right: 1rem;
  background   : transparent;
  box-sizing   : border-box;
  cursor       : pointer;
  font-weight  : 300 !important;
}

/* image layout */
#toc.toc2 #toctitle {
  background-image: url("images/AWS-Logo.svg");
  background-repeat: no-repeat;
  background-size: 50%;
  background-position: center;
  width: auto;
  height: 15%;
}

/* Left Navbar size */
#toc.toc2 {
  width: 17%;
  min-width: 15em;
}

/* auto width for main page */
body.toc2 {
  padding-left: 22%;
  padding-right: 2%;
}

/* hide left nav bar if page size is smaller than 767px */
@media screen and (max-width: 767px) {
  #toc {
      display: none !important;
  }
  body.toc2 {
    padding-left: 1%;
    padding-right: 1%;
    position: relative;
  }

  #content {
    padding-left: 2%;
    padding-right: 2%;
  }
}

/* QS Tables */

table.tableblock .title,
.imageblock .title {
  font-family  : "Amazon Ember Light", "Helvetica", "Tahoma", "Geneva", "Arial", sans-serif;
  font-size: 1.1rem;
  color: #34478c;
}
table p {
  margin: 0rem;
}

/* Add border around hyperlink images */
a img {
    border: 1px solid #A4A4A4;
}

.preview_mode {
	border-color:#e0e0dc;
	-webkit-box-shadow:0 1px 4px #e0e0dc;
	box-shadow:0 1px 4px #e0e0dc;
  background:#ffffb3;
  padding-bottom: 2rem;
}
.preview_mode .tableblock {
  background:#ffffb3;
}

.footer-text{color:rgba(255,255,255,.8);line-height:1.44;background:#1c222a;padding:1.25em;max-width:100%;margin-bottom:unset}
p.footer-text a{color:#d7d8d8}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#_overview">Overview</a></li>
<li><a href="#_web_application_proxy_and_ad_fs_on_aws">Web Application Proxy and AD FS on AWS</a></li>
<li><a href="#_aws_costs">AWS costs</a></li>
<li><a href="#_software_licenses">Software licenses</a></li>
<li><a href="#_architecture">Architecture</a></li>
<li><a href="#_planning_the_deployment">Planning the deployment</a>
<ul class="sectlevel2">
<li><a href="#_specialized_knowledge">Specialized knowledge</a></li>
<li><a href="#_aws_account">AWS account</a></li>
<li><a href="#_technical_requirements">Technical requirements</a></li>
</ul>
</li>
<li><a href="#_deployment_steps">Deployment steps</a>
<ul class="sectlevel2">
<li><a href="#_sign_in_to_your_aws_account">Sign in to your AWS account</a></li>
<li><a href="#_create_a_key_pair_in_your_preferred_region">Create a key pair in your preferred Region.</a></li>
<li><a href="#_if_necessary_request_a_service_limit_increase_for_the_amazon_ec2_c4_2xlarge_instance_type">If necessary, request a service limit increase for the Amazon EC2 <strong>c4.2xlarge</strong> instance type.</a></li>
<li><a href="#_launch_the_quick_start">Launch the Quick Start</a></li>
<li><a href="#_launch_into_a_new_vpc">Launch into a new VPC</a></li>
<li><a href="#_launch_into_an_existing_vpc">Launch into an existing VPC</a></li>
</ul>
</li>
<li><a href="#_post_deployment_steps">Post-deployment steps</a>
<ul class="sectlevel2">
<li><a href="#_run_windows_updates">Run Windows Updates</a></li>
</ul>
</li>
<li><a href="#design-considerations">Design Considerations</a>
<ul class="sectlevel2">
<li><a href="#selecting-an-instance-type">Selecting an Instance Type</a></li>
<li><a href="#database-options">Database Options</a></li>
<li><a href="#load-balancing">Load Balancing</a></li>
<li><a href="#certificates">Certificates</a></li>
<li><a href="#domain-joined-proxies">Domain-Joined Proxies</a></li>
<li><a href="#authentication-scenarios">Authentication Scenarios</a></li>
</ul>
</li>
<li><a href="#_security">Security</a>
<ul class="sectlevel2">
<li><a href="#operating-system-security">Operating System Security</a></li>
<li><a href="#security-groups">Security Groups</a></li>
</ul>
</li>
<li><a href="#_additional_resources">Additional Resources</a></li>
<li><a href="#_faq">FAQ</a></li>
<li><a href="#_appendix_publishing_outlook_web_app_to_the_internet_with_ad_fs_pre_authentication">Appendix: Publishing Outlook Web App to the Internet with AD FS Pre-Authentication</a></li>
<li><a href="#_customer_responsibility">Customer responsibility</a></li>
<li><a href="#_send_us_feedback">Send us feedback</a></li>
<li><a href="#_quick_start_reference_deployments">Quick Start reference deployments</a></li>
<li><a href="#_github_repository">GitHub repository</a></li>
<li><a href="#_notices">Notices</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<h2 id="_web_application_proxy_and_ad_fs_on_the_aws_cloud" class="discrete text-center">Web Application Proxy and AD FS on the AWS Cloud</h2>
<h2 id="_quick_start_reference_deployment" class="discrete text-left text-center">Quick Start Reference Deployment</h2>
<div class="imageblock text-center">
<div class="content">
<img src="https://aws-quickstart.s3.amazonaws.com/quickstart-microsoft-wapadfs/docs/boilerplate/.images/aws-quickstart-graphic.png" alt="QS" width="80" height="80">
</div>
</div>
<div class="paragraph text-center">
<p><strong>September 2020</strong><br>
<em>AWS Quick Start Reference Team</em></p>
</div>
<div class="admonitionblock tip text-left">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Visit our <a href="https://github.com/aws-quickstart/quickstart-microsoft-wapadfs" target="_blank" rel="noopener">GitHub repository</a> for source files and to post feedback,
report bugs, or submit feature ideas for this Quick Start.
</td>
</tr>
</table>
</div>
<div class="paragraph text-left">
<p>This Quick Start was created by Amazon Web Services (AWS). <a href="http://aws.amazon.com/quickstart/" target="_blank" rel="noopener">Quick Starts</a> are automated reference deployments that use AWS CloudFormation templates to deploy key technologies on AWS, following AWS best practices.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overview">Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This Quick Start reference deployment guide discusses architectural considerations and configuration steps for deploying a Web Application Proxy and Active Directory Federation Services (AD FS) environment on the Amazon Web Services (AWS) Cloud. It also provides links for viewing and launching <a href="https://aws.amazon.com/cloudformation/">AWS CloudFormation</a> templates that automate the deployment.</p>
</div>
<div class="paragraph">
<p>The guide is for IT infrastructure architects, administrators, and DevOps professionals who are planning to implement or extend their Web Application Proxy and AD FS workloads on the AWS Cloud.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_web_application_proxy_and_ad_fs_on_aws">Web Application Proxy and AD FS on AWS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Microsoft Active Directory Federation Services (AD FS) is a Windows Server role that provides identity federation and single sign-on (SSO) capabilities for users accessing applications in an AD FS-secured environment, or with federated partner organizations. Put simply, AD FS authenticates users and provides security tokens to applications or federated partner applications that trust AD FS.</p>
</div>
<div class="paragraph">
<p>For example, you could implement identity federation with AWS Identity and Access Management (IAM) and AD FS, and then use your Active Directory user name and password (instead of the AWS root account or IAM user credentials) to sign in to the AWS Management Console, or to make calls to AWS APIs.</p>
</div>
<div class="paragraph">
<p>Like domain controllers and other internal server workloads, AD FS servers are deployed in a private virtual private cloud (VPC) subnet. In order to make AD FS accessible to external users, you can deploy the Web Application Proxy role on Windows Server 2022. The Web Application Proxy server can proxy requests to the AD FS infrastructure for users who are connecting from an external location, without the need for VPN connectivity.</p>
</div>
<div class="paragraph">
<p>You can also use Web Application Proxy to selectively publish and pre-authenticate connections to internal web applications, allowing external users outside your organization to access those applications over the internet.</p>
</div>
<div class="paragraph">
<p>In this guide, well take a look at using your own Active Directory Domain Services (AD DS) infrastructure in AWS, along with AD FS and Web Application Proxy, to provide seamless external access to web applications running in AWS.</p>
</div>
<div class="paragraph">
<p>Some of the benefits and features of publishing applications with Web Application Proxy and AD FS are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Network isolation</strong>  Publishing web applications through Web Application Proxy means that back-end servers are never directly exposed to the internet. You can publish popular web-based workloads such as Microsoft SharePoint, Outlook Web App (OWA), Exchange ActiveSync, Lync (Skype for Business), and even custom web applications through Web Application Proxy.</p>
</li>
<li>
<p><strong>Denial-of-service (DoS) protection</strong>  The Web Application Proxy infrastructure uses several mechanisms to implement basic DoS protection, such as throttling and queuing, before routing connections to back-end web applications.</p>
</li>
<li>
<p><strong>Multi-factor authentication</strong>  Pre-authentication with AD FS provides support for smart cards, device authentication, and more.</p>
</li>
<li>
<p><strong>Single sign-on (SSO)</strong>  This functionality provides users with seamless access to applications without re-prompting for credentials after initial authentication.</p>
</li>
<li>
<p><strong>Workplace Join</strong> - Users can connect devices that are not typically domain-joined, such as personal laptops, tablets, and smartphones, to their companys resources. Known devices can be granted conditional access to applications, and you can require that devices register before gaining access to published applications.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For further details, see <a href="https://technet.microsoft.com/en-us/library/dn383650.aspx">Planning to Publish Applications Using Web Application Proxy</a> on Microsoft TechNet.</p>
</div>
<div class="paragraph">
<p>This guide and associated AWS CloudFormation template can be used in conjunction with <a href="https://aws.amazon.com/quickstart/">other AWS Quick Starts</a> to securely publish web applications running on SharePoint, Exchange, Lync, or your own web-based applications. The infrastructure deployed by this Quick Start enables external users to pre-authenticate to AD FS to access these web applications, without exposing the applications or AD FS infrastructure directly to the internet. You can also use this infrastructure to enable federation with AWS.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_aws_costs">AWS costs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You are responsible for the cost of the AWS services and any third-party licenses used while running this Quick Start. There is no additional cost for
using the Quick Start.</p>
</div>
<div class="paragraph">
<p>The AWS CloudFormation templates for Quick Starts include
configuration parameters that you can customize. Some of the settings,
such as the instance type, affect the cost of deployment. For cost estimates,
see the pricing pages for each AWS service you use. Prices are subject to change.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
After you deploy the Quick Start, create <a href="https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/billing-reports-gettingstarted-turnonreports.html" target="_blank" rel="noopener">AWS Cost and Usage Reports</a> to deliver billing metrics to an Amazon Simple Storage Service (Amazon S3) bucket in your account. These reports provide cost estimates based on usage throughout each month and aggregate the data at the end of the month. For more information, see <a href="https://docs.aws.amazon.com/cur/latest/userguide/what-is-cur.html" target="_blank" rel="noopener">What are AWS Cost and Usage Reports?</a>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_software_licenses">Software licenses</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This Quick Start deploys AWS EC2 instances running Microsoft Windows, and the cost of the Windows licenses is included in the cost of the EC2 instances.
All roles and functionality deployed on top of the Windows instances are included in the cost of the Windows licenses.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_architecture">Architecture</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Deploying this Quick Start for a new virtual private cloud (VPC) with
default parameters builds the following Web Application Proxy and AD FS environment in the
AWS Cloud.</p>
</div>
<div id="architecture1" class="imageblock">
<div class="content">
<a class="image" href="images/architecture_diagram.png"><img src="images/architecture_diagram.png" alt="Architecture" width="100%" height="100%"></a>
</div>
<div class="title">Figure 1. Quick Start architecture for <em>WAP and AD FS</em> on AWS</div>
</div>
<div class="paragraph">
<p>The AWS CloudFormation template creates a fully functional AD FS federation server farm with Web Application Proxy on the AWS Cloud. The template deploys the following components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A virtual private cloud (VPC) with resources distributed across two Availability Zones for high availability.*</p>
</li>
<li>
<p>Public subnets in each Availability Zone that provide access to and from the internet. The public subnets include network address translation (NAT) gateway instances for outbound internet access, and Remote Desktop Gateway (RD Gateway) instances in an Auto Scaling group for inbound remote administrative access. Web Application Proxy servers are deployed in the public subnets to help provide secure inbound connectivity to web applications.*</p>
</li>
<li>
<p>Private subnets in each Availability Zone for running enterprise workloads such as Active Directory domain controllers and AD FS servers, shielded from direct access over the internet.*</p>
</li>
<li>
<p>In the private subnets, domain controllers that act as enterprise certificate authorities (CAs) that issue the required SSL certificates to the AD FS infrastructure. For production deployments, you might want to consider commercial certificates issued from a public CA, and well cover this in greater detail later in this guide.</p>
</li>
<li>
<p>In the private subnets, two AD FS servers running on Windows Server 2022, which are deployed in each Availability Zone to support high availability and load distribution.</p>
</li>
<li>
<p>Security groups to tightly control the flow of traffic between your Amazon EC2 instances.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>*The template that deploys the Quick Start into an existing VPC skips
the components marked by asterisks and prompts you for your existing VPC
configuration.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_planning_the_deployment">Planning the deployment</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_specialized_knowledge">Specialized knowledge</h3>
<div class="paragraph">
<p>This deployment requires a moderate level of familiarity with
AWS services. If youre new to AWS, see <a href="https://aws.amazon.com/getting-started/" target="_blank" rel="noopener">Getting Started Resource Center</a>
and <a href="https://aws.amazon.com/training/" target="_blank" rel="noopener">AWS Training and Certification</a>. These sites provide materials for learning how to design,
deploy, and operate your infrastructure and applications on the AWS Cloud.</p>
</div>
<div class="paragraph">
<p>This Quick Start assumes familiarity with Microsoft Active Directory.</p>
</div>
</div>
<div class="sect2">
<h3 id="_aws_account">AWS account</h3>
<div class="paragraph">
<p>If you dont already have an AWS account, create one at <a href="https://aws.amazon.com/" target="_blank" rel="noopener">https://aws.amazon.com</a> by following the on-screen instructions. Part of the sign-up process involves receiving a phone call and entering a PIN using the phone keypad.</p>
</div>
<div class="paragraph">
<p>Your AWS account is automatically signed up for all AWS services. You are charged only for the services you use.</p>
</div>
</div>
<div class="sect2">
<h3 id="_technical_requirements">Technical requirements</h3>
<div class="paragraph">
<p>Before you launch the Quick Start, review the following information and ensure that your account is properly configured. Otherwise, deployment might fail.</p>
</div>
<div class="sect3">
<h4 id="_resource_quotas">Resource quotas</h4>
<div class="paragraph">
<p>If necessary, request <a href="https://console.aws.amazon.com/servicequotas/home?region=us-east-2#!/" target="_blank" rel="noopener">service quota increases</a> for the following resources. You might need to request increases if your existing deployment currently uses these resources and if this Quick Start deployment could result in exceeding the default quotas. The <a href="https://console.aws.amazon.com/servicequotas/home?region=us-east-2#!/" target="_blank" rel="noopener">Service Quotas console</a> displays your usage and quotas for some aspects of some services. For more information, see <a href="https://docs.aws.amazon.com/servicequotas/latest/userguide/intro.html" target="_blank" rel="noopener">What is Service Quotas?</a> and <a href="https://docs.aws.amazon.com/general/latest/gr/aws_service_limits.html" target="_blank" rel="noopener">AWS service quotas</a>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Resource</th>
<th class="tableblock halign-left valign-top">This deployment uses</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VPCs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Elastic IP addresses</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AWS Identity and Access Management (IAM) security groups</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IAM roles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EC2 instances</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_supported_aws_regions">Supported AWS Regions</h4>
<div class="paragraph">
<p>For any Quick Start to work in a Region other than its default Region, all the services it deploys must be supported in that Region. You can launch a Quick Start in any Region and see if it works. If you get an error such as Unrecognized resource type, the Quick Start is not supported in that Region.</p>
</div>
<div class="paragraph">
<p>For an up-to-date list of AWS Regions and the AWS services they support, see <a href="https://aws.amazon.com/about-aws/global-infrastructure/regional-product-services/" target="_blank" rel="noopener">AWS Regional Services</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Certain Regions are available on an opt-in basis. For more information, see <a href="https://docs.aws.amazon.com/general/latest/gr/rande-manage.html" target="_blank" rel="noopener">Managing AWS Regions</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_amazon_ec2_key_pairs">Amazon EC2 key pairs</h4>
<div class="paragraph">
<p>Ensure that at least one Amazon EC2 key pair exists in your AWS account in the Region where you plan to deploy the Quick Start. Note the key-pair name because you will use it during deployment. To create a key pair, see <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html" target="_blank" rel="noopener">Amazon EC2 key pairs and Linux instances</a>.</p>
</div>
<div class="paragraph">
<p>For testing or proof-of-concept purposes, we recommend creating a new key pair instead of using one thats already being used by a production instance.</p>
</div>
</div>
<div class="sect3">
<h4 id="_iam_permissions">IAM permissions</h4>
<div class="paragraph">
<p>Before launching the Quick Start, you must sign in to the AWS Management Console with IAM permissions for the resources that the templates deploy. The <em>AdministratorAccess</em> managed policy within IAM provides sufficient permissions, although your organization may choose to use a custom policy with more restrictions. For more information, see <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_job-functions.html" target="_blank" rel="noopener">AWS managed policies for job functions</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_deployment_options">Deployment options</h4>
<div class="paragraph">
<p>This Quick Start provides two deployment options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Deploy WAP and AD FS into a new VPC (end-to-end deployment)</strong>. This option builds a new AWS environment consisting of the VPC, subnets, NAT gateways, security groups, bastion hosts, and other infrastructure components. It then deploys WAP and AD FS into this new VPC.</p>
</li>
<li>
<p><strong>Deploy WAP and AD FS into an existing VPC</strong>. This option provisions WAP and AD FS in your existing AWS infrastructure.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Quick Start provides separate templates for these options. It also lets you configure Classless Inter-Domain Routing (CIDR) blocks, instance types, and WAP and AD FS settings, as discussed later in this guide.</p>
</div>
</div>
<div class="sect3">
<h4 id="_prepare_for_the_deployment">Prepare for the deployment</h4>
<div class="paragraph">
<p>If you are deploying the WAP ADFS Quick Start into an existing VPC, ensure your Active Directory environment includes at least one certificate authority (CA). If you are using AWS Managed Microsoft Active Directory this will require you to have at least one domain-joined server that can be configured as the CA, since AWS Managed Microsoft Active Directory does not act as a CA natively. A domain-joined server can be promoted to a CA by executing the following PowerShell code from an elevated command prompt:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Add-WindowsFeature Adcs-Cert-Authority -IncludeManagementTools
Install-AdcsCertificationAuthority -CAType EnterpriseRootCA</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_deployment_steps">Deployment steps</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_sign_in_to_your_aws_account">Sign in to your AWS account</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Sign in to your AWS account at <a href="https://aws.amazon.com" class="bare">https://aws.amazon.com</a> with an IAM user role that has the necessary permissions. For details, see <a href="#_planning_the_deployment">Planning the deployment</a> earlier in this guide.</p>
</li>
<li>
<p>Make sure that your AWS account is configured correctly, as discussed in the <a href="#_technical_requirements">Technical requirements</a> section.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_create_a_key_pair_in_your_preferred_region">Create a <a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html">key pair</a> in your preferred Region.</h3>
<div class="paragraph">
<p>To do this, in the navigation pane of the Amazon EC2 console, choose <strong>Key Pairs</strong>, <strong>Create Key Pair</strong>, type a name, and then choose <strong>Create</strong>.</p>
</div>
<div id="Deploy1" class="imageblock">
<div class="content">
<a class="image" href="images/image4.png"><img src="images/image4.png" alt="Deploy1" width="634" height="307"></a>
</div>
<div class="title">Figure 2. Creating a key pair</div>
</div>
<div class="paragraph">
<p>Amazon EC2 uses public-key cryptography to encrypt and decrypt login information. To be able to log in to your instances, you must create a key pair. With Windows instances, we use the key pair to obtain the administrator password via the Amazon EC2 console and then log in using Remote Desktop Protocol (RDP) as explained in the <a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html#having-ec2-create-your-key-pair">step-by-step instructions</a> in the <em>Amazon Elastic Compute Cloud User Guide</em>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_if_necessary_request_a_service_limit_increase_for_the_amazon_ec2_c4_2xlarge_instance_type">If necessary, <a href="https://console.aws.amazon.com/support/home#/case/create?issueType=service-limit-increase&amp;limitType=service-code-">request a service limit increase</a> for the Amazon EC2 <strong>c4.2xlarge</strong> instance type.</h3>
<div class="paragraph">
<p>To do this, in the AWS Support Center, choose <strong>Create Case</strong>, <strong>Service Limit Increase</strong>, <strong>EC2 instances</strong>, and then complete the fields in the limit increase form, as shown in Figure 4. The current default limit is 20 instances.</p>
</div>
<div class="paragraph">
<p>+
You might need to request an increase if you already have an existing deployment that uses this instance type, and you think you might exceed the default limit with this reference deployment. It might take a few days for the new service limit to become effective. For more information, see <a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-resource-limits.html">Amazon EC2 Service Limits</a> in the AWS documentation.</p>
</div>
<div class="paragraph">
<p><strong>Note</strong> The Quick Start uses five Elastic IP addresses by default: two for the NAT gateways, two for the proxies, and one for the RD Gateway instance. The default limit for Elastic IP addresses is five per AWS Region. If youre planning to deploy multiple RD Gateway instances by configuring the <strong>Number of RDGW Hosts</strong> parameter, we recommend that you also request an increase in the Elastic IP address limit: In the <a href="https://console.aws.amazon.com/support/home#/case/create?issueType=service-limit-increase&amp;limitType=service-code-">AWS Support Center</a>, choose <strong>Create Case</strong>, <strong>Service Limit Increase</strong>, <strong>Elastic IPs</strong>, and then complete the fields.</p>
</div>
<div id="Deploy2" class="imageblock">
<div class="content">
<a class="image" href="images/image5.png"><img src="images/image5.png" alt="Deploy2" width="648" height="425"></a>
</div>
<div class="title">Figure 3. Requesting a service limit increase</div>
</div>
</div>
<div class="sect2">
<h3 id="_launch_the_quick_start">Launch the Quick Start</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You are responsible for the cost of the AWS services used while running this Quick Start reference deployment. There is no additional cost for using this Quick Start. For full details, see the pricing pages for each AWS service used by this Quick Start. Prices are subject to change.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Sign in to your AWS account, and choose one of the following options to launch the AWS CloudFormation template. For help with choosing an option, see <a href="#_deployment_options">deployment options</a> earlier in this guide.</p>
</li>
</ol>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><a href="https://fwd.aws/eN64n" target="_blank" rel="noopener">Deploy WAP and AD FS into a new VPC on AWS</a></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><a href="https://github.com/aws-quickstart/quickstart-microsoft-wapadfs/blob/main/templates/wap-adfs-master.template" target="_blank" rel="noopener">View template</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><a href="https://fwd.aws/jpzqA" target="_blank" rel="noopener">Deploy WAP and AD FS into an existing VPC on AWS</a></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><a href="https://github.com/aws-quickstart/quickstart-microsoft-wapadfs/blob/main/templates/wap-adfs.template" target="_blank" rel="noopener">View template</a></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
If youre deploying WAP and AD FS into an existing VPC, make sure that your VPC has two private subnets in different Availability Zones for the workload instances, and that the subnets arent shared. This Quick Start doesnt support <a href="https://docs.aws.amazon.com/vpc/latest/userguide/vpc-sharing.html" target="_blank" rel="noopener">shared subnets</a>. These subnets require <a href="https://docs.aws.amazon.com/vpc/latest/userguide/vpc-nat-gateway.html" target="_blank" rel="noopener">NAT gateways</a> in their route tables, to allow the instances to download packages and software without exposing them to the internet.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Also, make sure that the domain name option in the DHCP options is configured as explained in the <a href="http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_DHCP_Options.html" target="_blank" rel="noopener">Amazon VPC documentation</a>. You provide your VPC settings when you launch the Quick Start.</p>
</div>
<div class="paragraph">
<p>Each deployment takes about 1 hour and 30 minutes to complete.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Check the AWS Region thats displayed in the upper-right corner of the navigation bar, and change it if necessary. This is where the network infrastructure for WAP and AD FS will be built. The template is launched in the us-east-1 Region by default.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>On the <strong>Create stack</strong> page, keep the default setting for the template URL, and then choose <strong>Next</strong>.</p>
</li>
<li>
<p>On the <strong>Specify stack details</strong> page, change the stack name if needed. Review the parameters for the template. Provide values for the parameters that require input. For all other parameters, review the default settings and customize them as necessary.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>+
In the following tables, parameters are listed by category and described separately for the deployment options. When you finish reviewing and customizing the parameters, choose <strong>Next</strong>.</p>
</div>
<div class="paragraph">
<p>+
NOTE: Unless you are customizing the Quick Start templates for your own deployment projects, keep the default settings for the parameters <strong>Quick Start S3 bucket name</strong>, <strong>Quick Start S3 bucket Region</strong>, and <strong>Quick Start S3 key prefix</strong>. Changing these settings automatically updates code references to point to a new Quick Start location. For more information, see the <a href="https://aws-quickstart.github.io/option1.html" target="_blank" rel="noopener">AWS Quick Start Contributors Guide</a>.</p>
</div>
<div class="paragraph">
<p>+</p>
</div>
</div>
<div class="sect2">
<h3 id="_launch_into_a_new_vpc">Launch into a new VPC</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Network Configuration</caption>
<colgroup>
<col style="width: 16%;">
<col style="width: 11%;">
<col style="width: 73%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter label (name)</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability Zones
(<code>AvailabilityZones</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong><em>Requires input</em></strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of Availability Zones to use for the subnets in the VPC. Note: The logical order is preserved and only 2 AZs are used for this deployment.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VPC CIDR
(<code>VPCCIDR</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10.0.0.0/16</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CIDR Block for the VPC</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Private Subnet 1 CIDR
(<code>PrivateSubnet1CIDR</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10.0.0.0/19</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CIDR block for private subnet 1 located in Availability Zone 1.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Private Subnet 2 CIDR
(<code>PrivateSubnet2CIDR</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10.0.32.0/19</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CIDR block for private subnet 2 located in Availability Zone 2.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Public Subnet 1 CIDR
(<code>PublicSubnet1CIDR</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10.0.128.0/20</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CIDR Block for the public DMZ subnet 1 located in Availability Zone 1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Public Subnet 2 CIDR
(<code>PublicSubnet2CIDR</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10.0.144.0/20</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CIDR Block for the public DMZ subnet 2 located in Availability Zone 2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allowed Remote Desktop Gateway external access CIDR
(<code>RDGWCIDR</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong><em>Requires input</em></strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allowed CIDR Block for external access to the Remote Desktop Gateways</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Amazon EC2 Configuration</caption>
<colgroup>
<col style="width: 16%;">
<col style="width: 11%;">
<col style="width: 73%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter label (name)</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Key Pair name
(<code>KeyPairName</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong><em>Requires input</em></strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Public/private key pairs allow you to securely connect to your instance after it launches</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Domain Controller 1 instance type
(<code>ADServerInstanceType</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>m5.large</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Amazon EC2 instance type for the Active Directory instances</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Domain Controller 1 NetBIOS name
(<code>ADServer1NetBIOSName</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DC1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NetBIOS name of the first Active Directory server (up to 15 characters)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Domain Controller 1 private IP address
(<code>ADServer1PrivateIP</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10.0.0.10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fixed private IP for the first Active Directory server located in Availability Zone 1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Domain Controller 2 NetBIOS Name
(<code>ADServer2NetBIOSName</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DC2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NetBIOS name of the second Active Directory server (up to 15 characters)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Domain Controller 2 private IP address
(<code>ADServer2PrivateIP</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10.0.32.10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fixed private IP for the second Active Directory server located in Availability Zone 2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Size of the domain controller data drive
(<code>DataDriveSizeGiB</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>20</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Size of data drive that contains SYSVOL and NTDS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Remote Desktop Gateway instance type
(<code>RDGWInstanceType</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>m5.large</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Amazon EC2 instance type for the Remote Desktop Gateway instances</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WAP and ADFS Server instance type
(<code>WAPADFSInstanceType</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>m5.large</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Amazon EC2 instance type for the WAP and ADFS servers</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Microsoft Active Directory Configuration</caption>
<colgroup>
<col style="width: 16%;">
<col style="width: 11%;">
<col style="width: 73%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter label (name)</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Domain DNS name
(<code>DomainDNSName</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>example.com</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fully qualified domain name (FQDN) of the forest root domain e.g. example.com</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Domain NetBIOS name
(<code>DomainNetBIOSName</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>example</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NetBIOS name of the domain (up to 15 characters) for users of earlier versions of Windows e.g. EXAMPLE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Domain Admin username
(<code>DomainAdminUser</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Admin</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User name for the account that will be added as alternate Domain Administrator. This is separate from the default "Administrator" account</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Domain Admin password
(<code>DomainAdminPassword</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong><em>Requires input</em></strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Password for the alternate domain admin user. Must be at least 8 characters containing letters, numbers and symbols</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. Microsoft Active Directory Certificate Services Configuration</caption>
<colgroup>
<col style="width: 16%;">
<col style="width: 11%;">
<col style="width: 73%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter label (name)</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Deploy PKI infrastructure
(<code>PKI</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>One-Tier</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Do you want to Deploy PKI Infrastructure if so what kind, Two Tier or One Tier</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Offline Root CA NetBIOS name
(<code>OrCaServerNetBIOSName</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ORCA1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NetBIOS name of the Offline Root CA server (Only Used For Two Tier PKI) (up to 15 characters)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enterprise Root CA NetBIOS name
(<code>EntCaServerNetBIOSName</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ENTCA1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NetBIOS name of the Enterprise Root or Subordinate CA server (up to 15 characters)</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. Microsoft Remote Desktop Gateway Configuration</caption>
<colgroup>
<col style="width: 16%;">
<col style="width: 11%;">
<col style="width: 73%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter label (name)</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of RDGW hosts
(<code>NumberOfRDGWHosts</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enter the number of Remote Desktop Gateway hosts to create</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 6. AWS Quick Start Configuration</caption>
<colgroup>
<col style="width: 16%;">
<col style="width: 11%;">
<col style="width: 73%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter label (name)</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Quick Start S3 bucket name
(<code>QSS3BucketName</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>aws-quickstart</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S3 bucket name for the Quick Start assets. Quick Start bucket name can include numbers, lowercase letters, uppercase letters, and hyphens (-). It cannot start or end with a hyphen (-).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Quick Start S3 bucket region
(<code>QSS3BucketRegion</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>us-east-1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The AWS Region where the Quick Start S3 bucket (QSS3BucketName) is hosted. When using your own bucket, you must specify this value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Quick Start S3 key prefix
(<code>QSS3KeyPrefix</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quickstart-microsoft-wapadfs/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S3 key prefix for the Quick Start assets. Quick Start key prefix can include numbers, lowercase letters, uppercase letters, hyphens (-), and forward slash (/).</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_launch_into_an_existing_vpc">Launch into an existing VPC</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 7. Network configuration</caption>
<colgroup>
<col style="width: 16%;">
<col style="width: 11%;">
<col style="width: 73%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter label (name)</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VPC CIDR
(<code>VPCCIDR</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10.0.0.0/16</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CIDR Block of the VPC</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VPC ID
(<code>VPCID</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong><em>Requires input</em></strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ID of the VPC (e.g., vpc-0343606e)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Private subnet 1 ID
(<code>PrivateSubnet1ID</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong><em>Requires input</em></strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ID of the private subnet 1 in Availability Zone 1 (e.g., subnet-a0246dcd)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Private subnet 2 ID
(<code>PrivateSubnet2ID</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong><em>Requires input</em></strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ID of the private subnet 2 in Availability Zone 2 (e.g., subnet-a0246dcd)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Public subnet 1 ID
(<code>PublicSubnet1ID</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong><em>Requires input</em></strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ID of the public subnet 1 in Availability Zone 1 (e.g., subnet-e3246d8e)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Public subnet 2 ID
(<code>PublicSubnet2ID</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong><em>Requires input</em></strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ID of the public subnet 2 in Availability Zone 2 (e.g., subnet-e3246d8e)</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 8. Amazon EC2 configuration</caption>
<colgroup>
<col style="width: 16%;">
<col style="width: 11%;">
<col style="width: 73%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter label (name)</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Key pair name
(<code>KeyPairName</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong><em>Requires input</em></strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Public/private key pairs allow you to securely connect to your instance after it launches</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SSM parameter to for latest AMI ID
(<code>LatestAmiId</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/aws/service/ami-windows-latest/Windows_Server-2022-English-Full-Base</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Systems Manager parameter value for latest Windows Server AMI</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">KMS Key for EBS encryption
(<code>EbsEncryptionKmsKeyId</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>alias/aws/ebs</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The identifier of the AWS KMS key to use for Amazon EBS encryption. You can specify the KMS key using any of the following; Key ID, Key alias, Key ARN, Alias ARN</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 9. Microsoft Active Directory Domain Services configuration</caption>
<colgroup>
<col style="width: 16%;">
<col style="width: 11%;">
<col style="width: 73%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter label (name)</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Active Directory Domain Services type
(<code>DirectoryType</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SelfManaged</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type of Active Directory the WAP / ADFS deployment will be integrated with, AWS Managed Microsoft AD or Self Managed AD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IP the instances will use for DNS (must be accessible)
(<code>DomainController1IP</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10.0.0.10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IP of DNS server that can resolve Active Directory domain (Must be accessible)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IP the instances will use for DNS (must be accessible)
(<code>DomainController2IP</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10.0.32.10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IP of DNS server that can resolve Active Directory domain (Must be accessible)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Domain DNS name
(<code>DomainDNSName</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>example.com</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fully qualified domain name (FQDN) of the domain the WAP / ADFS instances will join e.g. corp.example.com</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Domain NetBIOS name
(<code>DomainNetBIOSName</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>example</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NetBIOS name of the domain the WAP / ADFS instances will join (up to 15 characters) for users of earlier versions of Windows e.g. CORP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Secret ARN containing Administrator credentials
(<code>DomainAdminUserSecret</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong><em>Requires input</em></strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ARN for the Administrator credentials Secret with "username" and "password" key pairs. This account must be a member of Domain Admins with Self-Managed directories or a member of AWS Delegated Administrators with AWS Managed Microsoft AD.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Domain member security group ID
(<code>DomainMemberSGID</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong><em>Requires input</em></strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ID of the Domain Member Security Group (e.g., sg-7f16e910)</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 10. ADFS and WAP configuration</caption>
<colgroup>
<col style="width: 16%;">
<col style="width: 11%;">
<col style="width: 73%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter label (name)</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WAP and ADFS server instance type
(<code>WAPADFSInstanceType</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>m5.large</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Amazon EC2 instance type for the WAP and ADFS Instances</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ADFS server 1 NetBIOS name
(<code>Adfs1NetBIOSName</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ADFS1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First ADFS Server NetBIOS Name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ADFS server 2 NetBIOS name
(<code>Adfs2NetBIOSName</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ADFS2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Second ADFS Server NetBIOS Name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WAP server 1 NetBIOS name
(<code>Wap1NetBIOSName</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>WAP1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First WAP Server NetBIOS Name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WAP server 2 NetBIOS name
(<code>Wap2NetBIOSName</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>WAP2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Second WAP Server NetBIOS Name</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 11. AWS Quick Start configuration</caption>
<colgroup>
<col style="width: 16%;">
<col style="width: 11%;">
<col style="width: 73%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter label (name)</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Quick Start S3 bucket name
(<code>QSS3BucketName</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>aws-quickstart</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S3 bucket name for the Quick Start assets. Quick Start bucket name can include numbers, lowercase letters, uppercase letters, and hyphens (-). It cannot start or end with a hyphen (-).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Quick Start S3 bucket region
(<code>QSS3BucketRegion</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>us-east-1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The AWS Region where the Quick Start S3 bucket (QSS3BucketName) is hosted. When using your own bucket, you must specify this value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Quick Start S3 key prefix
(<code>QSS3KeyPrefix</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quickstart-microsoft-wapadfs/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S3 key prefix for the Quick Start assets. Quick Start key prefix can include numbers, lowercase letters, uppercase letters, hyphens (-), and forward slash (/).</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>+
. On the <strong>Configure stack options</strong> page, you can <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-resource-tags.html" target="_blank" rel="noopener">specify tags</a> (key-value pairs) for resources in your stack and <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-console-add-tags.html" target="_blank" rel="noopener">set advanced options</a>. When you finish, choose <strong>Next</strong>.
. On the <strong>Review</strong> page, review and confirm the template settings. Under <strong>Capabilities</strong>, select the two check boxes to acknowledge that the template creates IAM resources and might require the ability to automatically expand macros.
. Choose <strong>Create stack</strong> to deploy the stack.
. Monitor the status of the stack. When the status is <strong>CREATE_COMPLETE</strong>, the WAP and AD FS deployment is ready.
. To view the created resources, see the values displayed in the <strong>Outputs</strong> tab for the stack.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_post_deployment_steps">Post-deployment steps</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_run_windows_updates">Run Windows Updates</h3>
<div class="paragraph">
<p>In order to ensure the deployed servers' operating systems and installed applications have the latest Microsoft updates, run Windows Update on each server.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create an RDP session from the Remote Desktop Gateway server to each deployed server.</p>
</li>
<li>
<p>Open the <strong>Settings</strong> application.</p>
</li>
<li>
<p>Open <strong>Update &amp; Security</strong>.</p>
</li>
<li>
<p>Click <strong>Check for updates</strong>.</p>
</li>
<li>
<p>Install any updates and reboot if necessary.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="design-considerations">Design Considerations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This Quick Start is designed for a highly available AD FS implementation that supports 1,000 to 15,000 users, but there are a number of options available for architecting an AD FS deployment. Here are Microsofts recommendations for determining the minimum number of servers to deploy:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Fewer than 1,000 users</strong>  A small environment can use existing infrastructure instead of running dedicated AD FS servers. If you need to support fewer than 1,000 users, you can install AD FS on at least two of your domain controllers. Ideally, these domain controllers should be in two separate Availability Zones.</p>
</li>
<li>
<p><strong>1,000 to 15,000 users</strong>  In this scenario, Microsoft recommends using a dedicated AD FS and Web Application Proxy server infrastructure. The AD FS database can run using a Windows Internal Database (WID), so youll need four servers (two Web Application Proxy, two AD FS) in this architecture, as shown in Figure 1.</p>
</li>
<li>
<p><strong>15,000 to 60,000 users</strong>  For large environments, Microsoft recommends using three to five dedicated AD FS servers, and at least two dedicated Web Application Proxy servers. Note that if youre scaling beyond five dedicated AD FS servers, youll need a dedicated SQL Server instance instead of running a WID.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These recommendations are based on a hardware profile that supports 8 CPU cores, 4 GiB of RAM, and a 1 gigabit network connection.</p>
</div>
<div class="sect2">
<h3 id="selecting-an-instance-type">Selecting an Instance Type</h3>
<div class="paragraph">
<p>AD FS is considered a processor-bound workload, meaning that CPU resources are the highest in demand. This Quick Start uses C4 compute-optimized instances by default.</p>
</div>
<div class="paragraph">
<p>Specifically, the <strong>c4.2xlarge</strong> instance type is used to provide 8 vCPUs and 15 GiB of memory to meet or exceed requirements, based on the recommendations in the previous section. Additionally, the c4.2xlarge instance type supports Amazon EBS optimization, enhanced networking, and high network performance, which results in higher packets per second, lower latency, and lower jitter. Although c4.2xlarge provides more memory than required, its a great candidate for workloads running in a production environment.</p>
</div>
</div>
<div class="sect2">
<h3 id="database-options">Database Options</h3>
<div class="paragraph">
<p>The recommended topology for AD FS is to create a federation server farm that includes at least two AD FS servers. When you install AD FS on the first server, the federation server farm is created. You can join the next server to the farm, and then load-balance those servers.</p>
</div>
<div class="paragraph">
<p>An AD FS federation server farm uses a database to hold configuration data. For farms with five or fewer servers, you can use a Windows Internal Database (WID). The primary AD FS server will have a read/write copy of this database. The secondary AD FS servers in the farm receive updates from the primary server to a read-only copy of the WID. If the primary AD FS server fails, the secondary server can still process authentication requests, but you cannot make configuration changes until either the primary server is brought back online or the secondary server is converted to primary.</p>
</div>
<div class="paragraph">
<p>For federation server farms that have more than five AD FS servers, youll need to use a SQL Server database for the configuration database. When you use SQL Server for your AD FS database, all members in the federation server farm have write access to the configuration data.</p>
</div>
<div class="paragraph">
<p>Microsoft recommends that you use WID until you scale past five AD FS servers. This Quick Start utilizes WID with AD FS by default.</p>
</div>
</div>
<div class="sect2">
<h3 id="load-balancing">Load Balancing</h3>
<div class="paragraph">
<p>For production deployments, you should implement load balancing to make your Web Application Proxy and AD FS services highly available. You can use Elastic Load Balancing or a third-party virtual load balancer appliance.</p>
</div>
<div class="paragraph">
<p>Both the Web Application Proxy and AD FS layers can be load balanced individually with Elastic Load Balancing. You can deploy an Internet-facing load balancer for the Web Application Proxy layer that will service users accessing published web applications over the Internet. In addition, you can configure an internal load balancer for the AD FS servers. You would then configure the Web Application Proxy layer to point to the load-balanced DNS name (e.g., sts.example.com) that resolves to the internal load balancer.</p>
</div>
<div class="paragraph">
<p>In order to take advantage of header inspection, it is recommended that Application Load Balancers (rather than Network Load Balancers or Classic Load Balancers) be deployed. The Internet-facing load balancer for the Web Application Proxy layer should be configured to accept HTTPS requests on port 443 and forward these requests to the Web Application Proxy servers, and a certificate obtained from a trusted third-party Certificate Authority will need to be assigned to this listener. The internal load balancer will also be configured to accept HTTPS requests on port 443 but its listener can be assigned an internally-signed certificate.</p>
</div>
<div class="paragraph">
<p>See <a href="https://docs.microsoft.com/en-us/windows-server/identity/ad-fs/overview/ad-fs-requirements">Microsoft AD FS Requirements</a> for detailed load balancing and health check requirements.</p>
</div>
</div>
<div class="sect2">
<h3 id="certificates">Certificates</h3>
<div class="paragraph">
<p>Certificates are required to install both the Web Application Proxy and AD FS components. This Quick Start automates the deployment and installation of these components by using certificates issued from an internal enterprise certificate authority (CA), which runs on the domain controller infrastructure. You can replace these certificates in your own production deployments. The requirements and recommendations for both the Web Application Proxy and AD FS layers are discussed in the next two sections.</p>
</div>
<div class="sect3">
<h4 id="web-application-proxy-certificates">Web Application Proxy Certificates</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Issuing CA</strong>  Typically, the Web Application Proxy infrastructure will use certificates issued from a commercial or public CA, such as DigiCert or Verisign, which should be installed in the computers personal certificate store. Using a public CA generally prevents you from having to install root certificates on your client devices. You can use your own public key infrastructure (PKI) to issue the Web Application Proxy certificates, but youll need to ensure that client devices trust the issuing CA, which typically involves installing the root certificate on the devices as well as making the URL of your certificate revocation list externally accessible.</p>
</li>
<li>
<p><strong>Certificate FQDNs</strong>  You can explicitly set the certificate subject and subject alternative name (SAN) fields, or you can choose to use a wildcard certificate (e.g., *.example.com). For explicit naming, youll need to set the subject field to the AD FS federation service name (e.g., sts.example.com). If you plan to use the Workplace Join feature, youll also need two SAN entries: one for the federation service name (e.g., sts.example.com) and one for enterprise registration in the format enterpriseregistration.<em>yourdomain</em>.com. Additionally, youll want SAN entries for any fully qualified domain name (FQDN) that you will be publishing, such as externally facing SharePoint sites, OWA, etc.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="ad-fs-certificates">AD FS Certificates</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Issuing CA</strong>  Typically, the AD FS infrastructure will use certificates issued from an internal PKI, such as an enterprise Active Directory CA, because the servers in the infrastructure are not internet facing. This is especially useful in an Active Directory domain environment where all domain-joined machines will trust the issuing CA by default. If you choose not to domain-join your Web Application Proxy servers, you can install the CA root certificate on those servers in the computers trusted root certificate authority store. If you do not have an existing PKI implementation, its probably easiest to use the same public certificate on both the Web Application Proxy and AD FS servers.</p>
</li>
<li>
<p><strong>Certificate FQDNs</strong>  The AD FS certificate requires the federation service name to be set on the subject field (e.g., sts.example.com), or you can use a wildcard certificate.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="domain-joined-proxies">Domain-Joined Proxies</h3>
<div class="paragraph">
<p>You may choose not to domain-join your Web Application Proxy servers, because they will be placed in public virtual private cloud (VPC) subnets. This is a typical practice for server workloads running in a demilitarized zone (DMZ). However, if the web application you want to publish through Web Application Proxy must support Integrated Windows authentication, you should domain-join the Web Application Proxy server.</p>
</div>
<div class="paragraph">
<p>This Quick Start automatically joins the Web Application Proxy servers to the Active Directory Domain Services environment. See the #_Appendix:_Publishing_Outlook[appendix] for an example of how to publish a web application that uses Integrated Windows authentication.</p>
</div>
</div>
<div class="sect2">
<h3 id="authentication-scenarios">Authentication Scenarios</h3>
<div class="paragraph">
<p>Publishing web applications with Web Application Proxy supports three authentication scenarios:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>AD FS pre-authentication</strong>  In this scenario, users authenticate against AD FS before gaining access to the published web application. This requires that you add an AD FS relying party trust to the federation service. For detailed coverage on AD FS pre-authentication flow, see <a href="https://technet.microsoft.com/en-us/library/dn383640.aspx">Publish Applications using AD FS Preauthentication</a> in the Microsoft TechNet Library.</p>
</li>
<li>
<p><strong>Client certificate pre-authentication</strong>  In this scenario, one or more external servers connect to an on-premises web application through the Web Application Proxy infrastructure using a certificate for authentication. Despite the name, this scenario should not be used for client devices that connect to a published web application. For more information, see <a href="https://technet.microsoft.com/en-us/library/dn584096.aspx">Publish Applications using Client Certificate Preauthentication</a> in the Microsoft TechNet Library.</p>
</li>
<li>
<p><strong>Pass-through pre-authentication</strong>  In this scenario, access to the web application is proxied directly to the back-end server without pre-authentication against AD FS. For example, this is the option you would use to make AD FS externally accessible. Subsequently published applications that use AD FS pre-authentication will access AD FS via pass-through pre-authentication.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See the #_Appendix:_Publishing_Outlook[appendix] for an example that covers both AD FS and pass-through pre-authentication.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_security">Security</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you build systems on the AWS infrastructure, security responsibilities are shared between you and AWS. This shared model can reduce your operational burden as AWS operates, manages, and controls the components from the host operating system and virtualization layer down to the physical security of the facilities in which the services operate. In turn, you assume responsibility and management of the guest operating system (including updates and security patches), other associated applications, as well as the configuration of the AWS-provided security group firewall. For more information about security on AWS, visit the <a href="http://aws.amazon.com/security/">AWS Security Center</a>.</p>
</div>
<div class="sect2">
<h3 id="operating-system-security">Operating System Security</h3>
<div class="paragraph">
<p>All the Windows Servers deployed by this Quick Start are domain-joined. You can authenticate to these instances by using the <a href="mailto:stackadmin@example.com">stackadmin@example.com</a> domain administrator account. You can specify the password for this account as you launch the stack. You can retrieve the local administrator password for domain-joined instances by using the <em>KeyPairName</em> parameter specified during the launch. Operating system patches are your responsibility and should be performed on a periodic basis.</p>
</div>
</div>
<div class="sect2">
<h3 id="security-groups">Security Groups</h3>
<div class="paragraph">
<p>A <em>security group</em> acts as a firewall that controls the traffic for one or more instances. When you launch an instance, you associate one or more security groups with the instance. You add rules to each security group that allow traffic to or from its associated instances. You can modify the rules for a security group at any time. The new rules are automatically applied to all instances that are associated with the security group.</p>
</div>
<div class="paragraph">
<p>The security groups created and assigned to the individual instances as part of this solution are restricted as much as possible while allowing access to the various functions needed by AD FS and Web Application Proxy. We recommend that you review security groups and further restrict access as needed once the deployment is up and running.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_additional_resources">Additional Resources</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>AWS services</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>AWS CloudFormation<br>
<a href="https://aws.amazon.com/documentation/cloudformation/" class="bare">https://aws.amazon.com/documentation/cloudformation/</a></p>
</li>
<li>
<p>Amazon EBS</p>
</li>
<li>
<p>User guide: <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AmazonEBS.html" class="bare">https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AmazonEBS.html</a></p>
</li>
<li>
<p>Volume types: <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSVolumeTypes.html" class="bare">https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSVolumeTypes.html</a></p>
</li>
<li>
<p>Optimized instances: <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSOptimized.html" class="bare">https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSOptimized.html</a></p>
</li>
<li>
<p>Amazon EC2</p>
</li>
<li>
<p>User guide for Microsoft Windows: <a href="https://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/" class="bare">https://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/</a></p>
</li>
<li>
<p>Amazon VPC<br>
<a href="http://aws.amazon.com/documentation/vpc/" class="bare">http://aws.amazon.com/documentation/vpc/</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Microsoft Web Application Proxy and AD FS</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Planning for AD FS Server Capacity<br>
<a href="https://technet.microsoft.com/en-us/library/gg749899.aspx" class="bare">https://technet.microsoft.com/en-us/library/gg749899.aspx</a></p>
</li>
<li>
<p>Planning to Publish Applications Using Web Application Proxy<br>
<a href="https://technet.microsoft.com/en-us/library/dn383650.aspx" class="bare">https://technet.microsoft.com/en-us/library/dn383650.aspx</a></p>
</li>
<li>
<p>Configure the Web Application Proxy Infrastructure<br>
<a href="https://technet.microsoft.com/en-us/library/dn383644.aspx" class="bare">https://technet.microsoft.com/en-us/library/dn383644.aspx</a></p>
</li>
<li>
<p>Install and Configure the Web Application Proxy Server<br>
<a href="https://technet.microsoft.com/en-us/library/dn383662.aspx" class="bare">https://technet.microsoft.com/en-us/library/dn383662.aspx</a></p>
</li>
<li>
<p>Publish Applications using AD FS Preauthentication<br>
<a href="https://technet.microsoft.com/en-us/library/dn383640.aspx" class="bare">https://technet.microsoft.com/en-us/library/dn383640.aspx</a></p>
</li>
<li>
<p>Publish Applications using Pass-through Preauthentication<br>
<a href="https://technet.microsoft.com/en-us/library/dn383639.aspx" class="bare">https://technet.microsoft.com/en-us/library/dn383639.aspx</a></p>
</li>
<li>
<p>Enabling Federation to AWS using Windows Active Directory, ADFS, and SAML 2.0<br>
<a href="https://blogs.aws.amazon.com/security/post/Tx71TWXXJ3UI14/Enabling-Federation-to-AWS-using-Windows-Active-Directory-ADFS-and-SAML-2-0" class="bare">https://blogs.aws.amazon.com/security/post/Tx71TWXXJ3UI14/Enabling-Federation-to-AWS-using-Windows-Active-Directory-ADFS-and-SAML-2-0</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Deploying Microsoft software on AWS</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Microsoft on AWS<br>
<a href="https://aws.amazon.com/microsoft/" class="bare">https://aws.amazon.com/microsoft/</a></p>
</li>
<li>
<p>Secure Microsoft applications on AWS<br>
<a href="https://d0.awsstatic.com/whitepapers/aws-microsoft-platform-security.pdf" class="bare">https://d0.awsstatic.com/whitepapers/aws-microsoft-platform-security.pdf</a></p>
</li>
<li>
<p>Microsoft Licensing Mobility<br>
<a href="https://aws.amazon.com/windows/mslicensemobility/" class="bare">https://aws.amazon.com/windows/mslicensemobility/</a></p>
</li>
<li>
<p>MSDN on AWS<br>
<a href="https://aws.amazon.com/windows/msdn/" class="bare">https://aws.amazon.com/windows/msdn/</a></p>
</li>
<li>
<p>AWS Windows and .NET Developer Center<br>
<a href="https://aws.amazon.com/net/" class="bare">https://aws.amazon.com/net/</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Tools</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Best Practices Analyzer for Web Application Proxy<br>
<a href="https://technet.microsoft.com/en-us/library/dn383651.aspx" class="bare">https://technet.microsoft.com/en-us/library/dn383651.aspx</a></p>
</li>
<li>
<p>Load-balancing solutions in the AWS Marketplace<br>
<a href="https://aws.amazon.com/marketplace/" class="bare">https://aws.amazon.com/marketplace/</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Associated Quick Start reference deployments</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Microsoft Active Directory on AWS<br>
<a href="https://docs.aws.amazon.com/quickstart/latest/active-directory-ds/" class="bare">https://docs.aws.amazon.com/quickstart/latest/active-directory-ds/</a></p>
</li>
<li>
<p>Microsoft Remote Desktop Gateway on AWS<br>
<a href="https://docs.aws.amazon.com/quickstart/latest/rd-gateway/" class="bare">https://docs.aws.amazon.com/quickstart/latest/rd-gateway/</a></p>
</li>
<li>
<p>Additional reference deployments<br>
<a href="https://aws.amazon.com/quickstart/" class="bare">https://aws.amazon.com/quickstart/</a> <a id="_Appendix:_Publishing_Outlook"></a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_faq">FAQ</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Q.</strong> I encountered a <strong>CREATE_FAILED</strong> error when I launched the Quick Start.</p>
</div>
<div class="paragraph">
<p><strong>A.</strong> If AWS CloudFormation fails to create the stack, we recommend that you relaunch the template with <strong>Rollback on failure</strong> set to <strong>Disabled</strong>. (This setting is under <strong>Advanced</strong> in the AWS CloudFormation console, <strong>Options</strong> page.) With this setting, the stacks state is retained and the instance is left running, so you can troubleshoot the issue. (For Windows, look at the log files in %ProgramFiles%\Amazon\EC2ConfigService and C:\cfn\log.)</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
When you set <strong>Rollback on failure</strong> to <strong>Disabled</strong>, you continue to incur AWS charges for this stack. Please make sure to delete the stack when you finish troubleshooting.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For additional information, see <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/troubleshooting.html" target="_blank" rel="noopener">Troubleshooting AWS CloudFormation</a> on the AWS website.</p>
</div>
<div class="paragraph">
<p><strong>Q.</strong> I encountered a size limitation error when I deployed the AWS CloudFormation templates.</p>
</div>
<div class="paragraph">
<p><strong>A.</strong> We recommend that you launch the Quick Start templates from the links in this guide or from another S3 bucket. If you deploy the templates from a local copy on your computer or from a location other than an S3 bucket, you might encounter template size limitations. For more information about AWS CloudFormation quotas, see the <a href="http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cloudformation-limits.html" target="_blank" rel="noopener">AWS documentation</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_appendix_publishing_outlook_web_app_to_the_internet_with_ad_fs_pre_authentication">Appendix: Publishing Outlook Web App to the Internet with AD FS Pre-Authentication</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Instead of using the nested AWS CloudFormation template to launch a new environment, you can use the <a href="https://fwd.aws/YAkEy">Web Application Proxy and AD FS template</a> included with this Quick Start to launch the components into an existing VPC.</p>
</div>
<div class="paragraph">
<p><strong>Important</strong> The sub-template for Web Application Proxy and AD FS provided with this guide is built to work with existing VPCs that have two public and two private subnets, and an existing Active Directory Domain Services implementation. More specifically, it is designed to work with the existing Microsoft-based AWS Quick Starts, such as Exchange Server, SharePoint Server, and Lync Server.</p>
</div>
<div class="paragraph">
<p>In this appendix, well show you how to launch the Web Application Proxy and AD FS infrastructure on top of the Exchange Server Quick Start. Then well walk through the steps to publish Outlook Web App (OWA) to the internet using Web Application Proxy and AD FS.</p>
</div>
<div class="paragraph">
<p><strong>Note</strong> This walkthrough details the process of publishing OWA using Integrated Windows authentication. You can follow the same general process for Exchange Server 2010, or other web applications you want to publish with Integrated Windows authentication. It is also possible to publish OWA with claims-based authentication using Exchange Server 2013 SP1 or newer, but that scenario is beyond the scope of this guide.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Launch the <a href="https://fwd.aws/NvamP">Exchange Server Quick Start</a>.</p>
</li>
<li>
<p>Once the Exchange Server 2019 stack has been created successfully, launch the <a href="https://fwd.aws/5VrKP">Web Application Proxy and AD FS template</a>. As shown previously in this guide, youll need to specify the <em>KeyPairName</em> for your chosen region. Additionally, youll need to specify the IDs for your existing VPC and for the public and private subnets.</p>
</li>
<li>
<p>Initiate a Remote Desktop Protocol (RDP) connection to one of the RD Gateway instances. You can retrieve the Elastic IP for the RD Gateway servers in the Amazon EC2 console. From there, use RDP to connect to the EXCH1 server.</p>
</li>
<li>
<p>On EXCH1, navigate to the Exchange Admin Center (<a href="https://exch1/ecp" class="bare">https://exch1/ecp</a>) in a web browser. Sign in by using the stackadmin user account and password you specified when building the stack.</p>
</li>
</ol>
</div>
<div id="Additional1" class="imageblock">
<div class="content">
<a class="image" href="images/image6.png"><img src="images/image6.png" alt="Additional1" width="532" height="299"></a>
</div>
<div class="title">Figure 4. Logging into the Exchange Admin Center</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>In the left pane, choose <strong>Servers</strong>, <strong>Virtual directories</strong>.</p>
</li>
</ol>
</div>
<div id="Additional2" class="imageblock">
<div class="content">
<a class="image" href="images/image7.png"><img src="images/image7.png" alt="Additional2" width="546" height="308"></a>
</div>
<div class="title">Figure 5. Viewing the virtual directories on EXCH1</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Double-click <strong>owa (Default Web Site)</strong> on the EXCH1 server. Choose <strong>Authentication</strong>, <strong>Integrated Windows authentication</strong>, and then choose <strong>Save</strong>. You should also change the corresponding setting on the ECP virtual directory on EXCH1.</p>
</li>
</ol>
</div>
<div id="Additional3" class="imageblock">
<div class="content">
<a class="image" href="images/image8.png"><img src="images/image8.png" alt="Additional3" width="480" height="302"></a>
</div>
<div class="title">Figure 6. Setting OWA authentication to Integrated Windows</div>
</div>
<div class="paragraph">
<p><strong>Note</strong> In a load-balanced production environment, you would modify this setting on each Exchange server that is running the Client Access role.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Establish an RDP connection to the ADFS1 server. In <strong>Control Panel</strong>, choose <strong>Administrative Tools</strong>, and then launch the <strong>ADFS Management</strong> snap-in.</p>
</li>
<li>
<p>Open the context (right-click) menu for <strong>Trust Relationships</strong>, and then choose <strong>Add Non-Claims-Aware Relying Party Trust</strong> to start the wizard.</p>
</li>
</ol>
</div>
<div id="Additional4" class="imageblock">
<div class="content">
<a class="image" href="images/image9.png"><img src="images/image9.png" alt="Additional4" width="446" height="241"></a>
</div>
<div class="title">Figure 7. Adding a non-claims-aware relying party trust</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="9">
<li>
<p>On the welcome page of the wizard, choose <strong>Start</strong>, and type a display name such as <strong>OWA</strong>. Provide a unique identifier string for the non-claims-aware relying party trust. Use the default service name created by the Quick Start (e.g., <a href="http://sts.example.com/adfs/services/trust" class="bare">http://sts.example.com/adfs/services/trust</a>) for the URL.</p>
</li>
<li>
<p>Indicate that you do not want to configure multi-factor authentication, and then choose <strong>Next</strong>.</p>
</li>
<li>
<p>Go through the remaining screens without making changes. On the final screen, leave the <strong>Open the Edit Issuance Authorization Rules</strong> option selected, and then choose <strong>Close</strong>.</p>
</li>
<li>
<p>On the <strong>Edit Claim Rules</strong> screen, choose <strong>Add Rule</strong>, <strong>Permit Access to All Users</strong>, and then choose <strong>Finish</strong>.</p>
</li>
<li>
<p>Establish an RDP connection to the WAP1 server. In <strong>Control Panel</strong>, choose <strong>Administrative Tools</strong>, and then launch the <strong>Remote Access Management</strong> snap-in.</p>
</li>
</ol>
</div>
<div id="Additional5" class="imageblock">
<div class="content">
<a class="image" href="images/image10.png"><img src="images/image10.png" alt="Additional5" width="603" height="145"></a>
</div>
<div class="title">Figure 8. Viewing the Remote Access Management console</div>
</div>
<div class="paragraph">
<p>To publish OWA to the internet, youll need to create two rules. The first rule will be a pass-through authentication rule to the AD FS server. This will allow users to pre-authenticate before being connected to OWA.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="14">
<li>
<p>Under <strong>Tasks</strong>, choose <strong>Publish</strong>.</p>
</li>
<li>
<p>On the Welcome screen, choose <strong>Next</strong>. On the <strong>Preauthentication</strong> tab, choose <strong>Pass-through</strong>.</p>
</li>
</ol>
</div>
<div id="Additional6" class="imageblock">
<div class="content">
<a class="image" href="images/image11.png"><img src="images/image11.png" alt="Additional6" width="486" height="183"></a>
</div>
<div class="title">Figure 9. Selecting the pass-through pre-authentication method</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="16">
<li>
<p>Provide a name such as ADFS for the rule. Specify the external URL, the external certificate, and the back-end server URL as shown in Figure 11.</p>
</li>
</ol>
</div>
<div id="Additional7" class="imageblock">
<div class="content">
<a class="image" href="images/image12.png"><img src="images/image12.png" alt="Additional7" width="488" height="233"></a>
</div>
<div class="title">Figure 10. Configuring the publishing rule</div>
</div>
<div class="paragraph">
<p><strong>Note</strong> If youve implemented internal load balancing for the AD FS tier, you can set the back-end server URL to a load-balanced endpoint instead of an individual server name.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="17">
<li>
<p>Choose <strong>Publish,</strong> and then <strong>Close</strong> to exit the wizard.</p>
</li>
<li>
<p>Choose <strong>Publish</strong> again to create a new rule for OWA. This time, set the pre-authentication method to <strong>Active Directory Federation Services (AD FS)</strong>, and then choose <strong>Next</strong>.</p>
</li>
</ol>
</div>
<div id="Additional8" class="imageblock">
<div class="content">
<a class="image" href="images/image13.png"><img src="images/image13.png" alt="Additional8" width="488" height="233"></a>
</div>
<div class="title">Figure 11. Selecting the AD FS pre-authentication method</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="19">
<li>
<p>For the relying party for the application, select the relying party trust you created on the AD FS server, and then choose <strong>Next</strong>.</p>
</li>
</ol>
</div>
<div id="Additional9" class="imageblock">
<div class="content">
<a class="image" href="images/image14.png"><img src="images/image14.png" alt="Additional9" width="488" height="233"></a>
</div>
<div class="title">Figure 12. Selecting the relying party</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="20">
<li>
<p>Provide a name such as OWA for the rule. Specify the external URL, external certificate, back-end URL, and service principal name (SPN) for the back-end server, as shown in Figure 14.</p>
</li>
</ol>
</div>
<div id="Additional10" class="imageblock">
<div class="content">
<a class="image" href="images/image15.png"><img src="images/image15.png" alt="Additional10" width="488" height="233"></a>
</div>
<div class="title">Figure 13. Configuring rule details</div>
</div>
<div class="paragraph">
<p><strong>Note</strong> If youve implemented internal load balancing for the Exchange client access tier, you can set the back-end server URL and SPN to a load-balanced endpoint instead of an individual server name.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="21">
<li>
<p>Choose <strong>Publish</strong> and close the wizard.</p>
</li>
<li>
<p>Establish an RDP connection to DC1. In <strong>Control Panel</strong>, choose <strong>Administrative Tools</strong>, and then launch the <strong>Active Directory Users and Computers</strong> snap-in.</p>
</li>
<li>
<p>Navigate to the <strong>Computers</strong> container, right-click the WAP1 computer, and then choose <strong>Properties</strong>. On the <strong>Delegation</strong> tab, choose <strong>Trust this computer for delegation to specified services only</strong>. Check the option to use any authentication protocol, and add the HTTP service type on the EXCH1 computer to the list, as shown in Figure 15. Choose <strong>Apply</strong>, and then choose <strong>OK</strong>.</p>
</li>
</ol>
</div>
<div id="Additional11" class="imageblock">
<div class="content">
<a class="image" href="images/image16.png"><img src="images/image16.png" alt="Additional11" width="315" height="353"></a>
</div>
<div class="title">Figure 14. Configuring Kerberos constrained delegation</div>
</div>
<div class="paragraph">
<p>Now you are ready to test accessing OWA from an external workstation or server over the internet.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="24">
<li>
<p>If you did not use your own domain name, youll need to edit the hosts file on your machine to allow your computer to resolve the endpoints at example.com: Add a mapping for <strong>sts.example.com</strong> and <strong>mail.example.com</strong> to your local hosts file, making sure that both hosts resolve to the public EIP of the WAP1 server.</p>
</li>
<li>
<p>Open a web browser from your external workstation or server. Navigate to <strong>mail.example.com</strong>. You should be redirected to the federation service and prompted for authentication. Provide the stackadmin user name and password, and then choose <strong>Sign in</strong>.</p>
</li>
</ol>
</div>
<div id="Additional12" class="imageblock">
<div class="content">
<a class="image" href="images/image17.png"><img src="images/image17.png" alt="Additional12" width="315" height="353"></a>
</div>
<div class="title">Figure 15. Pre-authenticating to AD FS</div>
</div>
<div class="paragraph">
<p>If the authentication is successful, the connection should be proxied to the EXCH1 server through the Web Application Proxy, as shown in Figure 17.</p>
</div>
<div id="Additional13" class="imageblock">
<div class="content">
<a class="image" href="images/image18.png"><img src="images/image18.png" alt="Additional13" width="315" height="353"></a>
</div>
<div class="title">Figure 16. Connected to the published application</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_customer_responsibility">Customer responsibility</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After you successfully deploy this Quick Start, confirm that your resources and services are updated and configured  including any required patches  to meet your security and other needs. For more information, see the <a href="https://aws.amazon.com/compliance/shared-responsibility-model/" target="_blank" rel="noopener">AWS Shared Responsibility Model</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_send_us_feedback">Send us feedback</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To post feedback, submit feature ideas, or report bugs, use the <strong>Issues</strong> section of the <a href="https://github.com/aws-quickstart/quickstart-microsoft-wapadfs" target="_blank" rel="noopener">GitHub repository</a> for this Quick Start. To submit code, see the <a href="https://aws-quickstart.github.io/" target="_blank" rel="noopener">Quick Start Contributors Guide</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_quick_start_reference_deployments">Quick Start reference deployments</h2>
<div class="sectionbody">
<div class="paragraph">
<p>See the <a href="https://aws.amazon.com/quickstart/" target="_blank" rel="noopener">AWS Quick Start home page</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_github_repository">GitHub repository</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Visit our <a href="https://github.com/aws-quickstart/quickstart-microsoft-wapadfs" target="_blank" rel="noopener">GitHub repository</a> to download
the templates and scripts for this Quick Start, to post your comments,
and to share your customizations with others.</p>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_notices">Notices</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This document is provided for informational purposes only. It represents AWSs current product offerings and practices as of the date of issue of this document, which are subject to change without notice. Customers are responsible for making their own independent assessment of the information in this document and any use of AWSs products or services, each of which is provided as is without warranty of any kind, whether expressed or implied. This document does not create any warranties, representations, contractual commitments, conditions, or assurances from AWS, its affiliates, suppliers, or licensors. The responsibilities and liabilities of AWS to its customers are controlled by AWS agreements, and this document is not part of, nor does it modify, any agreement between AWS and its customers.</p>
</div>
<div class="paragraph">
<p>The software included with this paper is licensed under the Apache License, version 2.0 (the "License"). You may not use this file except in compliance with the License. A copy of the License is located at <a href="http://aws.amazon.com/apache2.0/" target="_blank" rel="noopener">http://aws.amazon.com/apache2.0/</a> or in the accompanying "license" file. This code is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either expressed or implied. See the License for specific language governing permissions and limitations.</p>
</div>
</div>
</div>
</div>
<p class="footer-text">
<!-- We can use document attributes: -->
<!-- Generated with Asciidoctor v2.0.16. -->
<a href="https://aws.amazon.com/privacy/">Privacy</a> | <a href="https://aws.amazon.com/terms/">Site terms</a> | &copy; 2021, Amazon Web Services, Inc. or its affiliates. All rights reserved.
</p>
</body>
</html>
<!--
repo commit:
bed3ea96a8bc7e25f324c38a96be1c2aee92c8fe

submodule config:
 4b446ee8ff99a231295d8e38ebff4bcb68325bd9 docs/boilerplate (remotes/origin/cdk-27-g4b446ee)
 b7aefd089e944d77cdc2b083886cdc498d2a6ee4 submodules/quickstart-aws-vpc (v1.0-59-gb7aefd0)
 7c7b86e2c7397d5210d19758f8e3e75c60fd1bde submodules/quickstart-microsoft-activedirectory (heads/main)
 f282fbb4e807dd4b4044244361d260c4f206bf0c submodules/quickstart-microsoft-rdgateway (heads/main)
 1a304a96c2e934f48a8f21b7716c392b299bcc8e submodules/quickstart-microsoft-utilities (heads/main)
-->
